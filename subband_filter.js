/////////////////////////////////////////////////////////////////
//
//  Project Aqua - MP3 Audio Encoder / MP3音频编码器
//
//  Copyright (c) 2019-2020 Mikukonai @ GitHub
//
//  =============================================================
//
//  subband_filter.js
//
//    分析子带滤波器。包含滤波算法和常数表。
//
/////////////////////////////////////////////////////////////////


/**
 * @description 分析子带滤波器的窗口系数
 * @reference Table.C.1(p68-69)
 */
const ANALYSIS_SUBBAND_FILTER_WINDOW_COEFFICIENTS = [
    0.000000000 , -0.000000477 , -0.000000477 , -0.000000477 ,
   -0.000000477 , -0.000000477 , -0.000000477 , -0.000000954 ,
   -0.000000954 , -0.000000954 , -0.000000954 , -0.000001431 ,
   -0.000001431 , -0.000001907 , -0.000001907 , -0.000002384 ,
   -0.000002384 , -0.000002861 , -0.000003338 , -0.000003338 ,
   -0.000003815 , -0.000004292 , -0.000004768 , -0.000005245 ,
   -0.000006199 , -0.000006676 , -0.000007629 , -0.000008106 ,
   -0.000009060 , -0.000010014 , -0.000011444 , -0.000012398 ,
   -0.000013828 , -0.000014782 , -0.000016689 , -0.000018120 ,
   -0.000019550 , -0.000021458 , -0.000023365 , -0.000025272 ,
   -0.000027657 , -0.000030041 , -0.000032425 , -0.000034809 ,
   -0.000037670 , -0.000040531 , -0.000043392 , -0.000046253 ,
   -0.000049591 , -0.000052929 , -0.000055790 , -0.000059605 ,
   -0.000062943 , -0.000066280 , -0.000070095 , -0.000073433 ,
   -0.000076771 , -0.000080585 , -0.000083923 , -0.000087261 ,
   -0.000090599 , -0.000093460 , -0.000096321 , -0.000099182 ,
    0.000101566 ,  0.000103951 ,  0.000105858 ,  0.000107288 ,
    0.000108242 ,  0.000108719 ,  0.000108719 ,  0.000108242 ,
    0.000106812 ,  0.000105381 ,  0.000102520 ,  0.000099182 ,
    0.000095367 ,  0.000090122 ,  0.000084400 ,  0.000077724 ,
    0.000069618 ,  0.000060558 ,  0.000050545 ,  0.000039577 ,
    0.000027180 ,  0.000013828 , -0.000000954 , -0.000017166 ,
   -0.000034332 , -0.000052929 , -0.000072956 , -0.000093937 ,
   -0.000116348 , -0.000140190 , -0.000165462 , -0.000191212 ,
   -0.000218868 , -0.000247478 , -0.000277042 , -0.000307560 ,
   -0.000339031 , -0.000371456 , -0.000404358 , -0.000438213 ,
   -0.000472546 , -0.000507355 , -0.000542164 , -0.000576973 ,
   -0.000611782 , -0.000646591 , -0.000680923 , -0.000714302 ,
   -0.000747204 , -0.000779152 , -0.000809669 , -0.000838757 ,
   -0.000866413 , -0.000891685 , -0.000915051 , -0.000935555 ,
   -0.000954151 , -0.000968933 , -0.000980854 , -0.000989437 ,
   -0.000994205 , -0.000995159 , -0.000991821 , -0.000983715 ,
    0.000971317 ,  0.000953674 ,  0.000930786 ,  0.000902653 ,
    0.000868797 ,  0.000829220 ,  0.000783920 ,  0.000731945 ,
    0.000674248 ,  0.000610352 ,  0.000539303 ,  0.000462532 ,
    0.000378609 ,  0.000288486 ,  0.000191689 ,  0.000088215 ,
   -0.000021458 , -0.000137329 , -0.000259876 , -0.000388145 ,
   -0.000522137 , -0.000661850 , -0.000806808 , -0.000956535 ,
   -0.001111031 , -0.001269817 , -0.001432419 , -0.001597881 ,
   -0.001766682 , -0.001937389 , -0.002110004 , -0.002283096 ,
   -0.002457142 , -0.002630711 , -0.002803326 , -0.002974033 ,
   -0.003141880 , -0.003306866 , -0.003467083 , -0.003622532 ,
   -0.003771782 , -0.003914356 , -0.004048824 , -0.004174709 ,
   -0.004290581 , -0.004395962 , -0.004489899 , -0.004570484 ,
   -0.004638195 , -0.004691124 , -0.004728317 , -0.004748821 ,
   -0.004752159 , -0.004737377 , -0.004703045 , -0.004649162 ,
   -0.004573822 , -0.004477024 , -0.004357815 , -0.004215240 ,
   -0.004049301 , -0.003858566 , -0.003643036 , -0.003401756 ,
    0.003134727 ,  0.002841473 ,  0.002521515 ,  0.002174854 ,
    0.001800537 ,  0.001399517 ,  0.000971317 ,  0.000515938 ,
    0.000033379 , -0.000475883 , -0.001011848 , -0.001573563 ,
   -0.002161503 , -0.002774239 , -0.003411293 , -0.004072189 ,
   -0.004756451 , -0.005462170 , -0.006189346 , -0.006937027 ,
   -0.007703304 , -0.008487225 , -0.009287834 , -0.010103703 ,
   -0.010933399 , -0.011775017 , -0.012627602 , -0.013489246 ,
   -0.014358521 , -0.015233517 , -0.016112804 , -0.016994476 ,
   -0.017876148 , -0.018756866 , -0.019634247 , -0.020506859 ,
   -0.021372318 , -0.022228718 , -0.023074150 , -0.023907185 ,
   -0.024725437 , -0.025527000 , -0.026310921 , -0.027073860 ,
   -0.027815342 , -0.028532982 , -0.029224873 , -0.029890060 ,
   -0.030526638 , -0.031132698 , -0.031706810 , -0.032248020 ,
   -0.032754898 , -0.033225536 , -0.033659935 , -0.034055710 ,
   -0.034412861 , -0.034730434 , -0.035007000 , -0.035242081 ,
   -0.035435200 , -0.035586357 , -0.035694122 , -0.035758972 ,
    0.035780907 ,  0.035758972 ,  0.035694122 ,  0.035586357 ,
    0.035435200 ,  0.035242081 ,  0.035007000 ,  0.034730434 ,
    0.034412861 ,  0.034055710 ,  0.033659935 ,  0.033225536 ,
    0.032754898 ,  0.032248020 ,  0.031706810 ,  0.031132698 ,
    0.030526638 ,  0.029890060 ,  0.029224873 ,  0.028532982 ,
    0.027815342 ,  0.027073860 ,  0.026310921 ,  0.025527000 ,
    0.024725437 ,  0.023907185 ,  0.023074150 ,  0.022228718 ,
    0.021372318 ,  0.020506859 ,  0.019634247 ,  0.018756866 ,
    0.017876148 ,  0.016994476 ,  0.016112804 ,  0.015233517 ,
    0.014358521 ,  0.013489246 ,  0.012627602 ,  0.011775017 ,
    0.010933399 ,  0.010103703 ,  0.009287834 ,  0.008487225 ,
    0.007703304 ,  0.006937027 ,  0.006189346 ,  0.005462170 ,
    0.004756451 ,  0.004072189 ,  0.003411293 ,  0.002774239 ,
    0.002161503 ,  0.001573563 ,  0.001011848 ,  0.000475883 ,
   -0.000033379 , -0.000515938 , -0.000971317 , -0.001399517 ,
   -0.001800537 , -0.002174854 , -0.002521515 , -0.002841473 ,
    0.003134727 ,  0.003401756 ,  0.003643036 ,  0.003858566 ,
    0.004049301 ,  0.004215240 ,  0.004357815 ,  0.004477024 ,
    0.004573822 ,  0.004649162 ,  0.004703045 ,  0.004737377 ,
    0.004752159 ,  0.004748821 ,  0.004728317 ,  0.004691124 ,
    0.004638195 ,  0.004570484 ,  0.004489899 ,  0.004395962 ,
    0.004290581 ,  0.004174709 ,  0.004048824 ,  0.003914356 ,
    0.003771782 ,  0.003622532 ,  0.003467083 ,  0.003306866 ,
    0.003141880 ,  0.002974033 ,  0.002803326 ,  0.002630711 ,
    0.002457142 ,  0.002283096 ,  0.002110004 ,  0.001937389 ,
    0.001766682 ,  0.001597881 ,  0.001432419 ,  0.001269817 ,
    0.001111031 ,  0.000956535 ,  0.000806808 ,  0.000661850 ,
    0.000522137 ,  0.000388145 ,  0.000259876 ,  0.000137329 ,
    0.000021458 , -0.000088215 , -0.000191689 , -0.000288486 ,
   -0.000378609 , -0.000462532 , -0.000539303 , -0.000610352 ,
   -0.000674248 , -0.000731945 , -0.000783920 , -0.000829220 ,
   -0.000868797 , -0.000902653 , -0.000930786 , -0.000953674 ,
    0.000971317 ,  0.000983715 ,  0.000991821 ,  0.000995159 ,
    0.000994205 ,  0.000989437 ,  0.000980854 ,  0.000968933 ,
    0.000954151 ,  0.000935555 ,  0.000915051 ,  0.000891685 ,
    0.000866413 ,  0.000838757 ,  0.000809669 ,  0.000779152 ,
    0.000747204 ,  0.000714302 ,  0.000680923 ,  0.000646591 ,
    0.000611782 ,  0.000576973 ,  0.000542164 ,  0.000507355 ,
    0.000472546 ,  0.000438213 ,  0.000404358 ,  0.000371456 ,
    0.000339031 ,  0.000307560 ,  0.000277042 ,  0.000247478 ,
    0.000218868 ,  0.000191212 ,  0.000165462 ,  0.000140190 ,
    0.000116348 ,  0.000093937 ,  0.000072956 ,  0.000052929 ,
    0.000034332 ,  0.000017166 ,  0.000000954 , -0.000013828 ,
   -0.000027180 , -0.000039577 , -0.000050545 , -0.000060558 ,
   -0.000069618 , -0.000077724 , -0.000084400 , -0.000090122 ,
   -0.000095367 , -0.000099182 , -0.000102520 , -0.000105381 ,
   -0.000106812 , -0.000108242 , -0.000108719 , -0.000108719 ,
   -0.000108242 , -0.000107288 , -0.000105858 , -0.000103951 ,
    0.000101566 ,  0.000099182 ,  0.000096321 ,  0.000093460 ,
    0.000090599 ,  0.000087261 ,  0.000083923 ,  0.000080585 ,
    0.000076771 ,  0.000073433 ,  0.000070095 ,  0.000066280 ,
    0.000062943 ,  0.000059605 ,  0.000055790 ,  0.000052929 ,
    0.000049591 ,  0.000046253 ,  0.000043392 ,  0.000040531 ,
    0.000037670 ,  0.000034809 ,  0.000032425 ,  0.000030041 ,
    0.000027657 ,  0.000025272 ,  0.000023365 ,  0.000021458 ,
    0.000019550 ,  0.000018120 ,  0.000016689 ,  0.000014782 ,
    0.000013828 ,  0.000012398 ,  0.000011444 ,  0.000010014 ,
    0.000009060 ,  0.000008106 ,  0.000007629 ,  0.000006676 ,
    0.000006199 ,  0.000005245 ,  0.000004768 ,  0.000004292 ,
    0.000003815 ,  0.000003338 ,  0.000003338 ,  0.000002861 ,
    0.000002384 ,  0.000002384 ,  0.000001907 ,  0.000001907 ,
    0.000001431 ,  0.000001431 ,  0.000000954 ,  0.000000954 ,
    0.000000954 ,  0.000000954 ,  0.000000477 ,  0.000000477 ,
    0.000000477 ,  0.000000477 ,  0.000000477 ,  0.000000477
];

const M_Mat = [
    [0.7071067811865476,0.7409511253549592,0.773010453362737,0.8032075314806449,0.8314696123025452,0.8577286100002721,0.881921264348355,0.9039892931234433,0.9238795325112867,0.9415440651830208,0.9569403357322088,0.970031253194544,0.9807852804032304,0.989176509964781,0.9951847266721969,0.9987954562051724,1,0.9987954562051724,0.9951847266721969,0.989176509964781,0.9807852804032304,0.970031253194544,0.9569403357322088,0.9415440651830208,0.9238795325112867,0.9039892931234433,0.881921264348355,0.8577286100002721,0.8314696123025452,0.8032075314806449,0.773010453362737,0.7409511253549592,0.7071067811865476,0.6715589548470184,0.6343932841636455,0.5956993044924335,0.5555702330196023,0.5141027441932217,0.4713967368259978,0.4275550934302822,0.38268343236508984,0.33688985339222005,0.29028467725446233,0.24298017990326398,0.19509032201612833,0.14673047445536175,0.09801714032956077,0.049067674327418126,6.123233995736766e-17,-0.04906767432741801,-0.09801714032956065,-0.14673047445536164,-0.1950903220161282,-0.24298017990326387,-0.29028467725446216,-0.33688985339221994,-0.3826834323650897,-0.42755509343028186,-0.4713967368259977,-0.5141027441932216,-0.555570233019602,-0.5956993044924334,-0.6343932841636454,-0.6715589548470184],
    [-0.7071067811865475,-0.5956993044924334,-0.4713967368259977,-0.33688985339221994,-0.1950903220161282,-0.04906767432741801,0.09801714032956077,0.24298017990326398,0.38268343236508984,0.5141027441932217,0.6343932841636455,0.7409511253549592,0.8314696123025452,0.9039892931234433,0.9569403357322088,0.989176509964781,1,0.989176509964781,0.9569403357322088,0.9039892931234433,0.8314696123025452,0.7409511253549592,0.6343932841636455,0.5141027441932217,0.38268343236508984,0.24298017990326398,0.09801714032956077,-0.04906767432741801,-0.1950903220161282,-0.33688985339221994,-0.4713967368259977,-0.5956993044924334,-0.7071067811865475,-0.8032075314806448,-0.8819212643483549,-0.9415440651830207,-0.9807852804032304,-0.9987954562051724,-0.9951847266721969,-0.970031253194544,-0.9238795325112868,-0.8577286100002721,-0.7730104533627371,-0.6715589548470187,-0.5555702330196022,-0.4275550934302825,-0.29028467725446244,-0.1467304744553623,-1.8369701987210297e-16,0.14673047445536194,0.29028467725446205,0.42755509343028214,0.5555702330196018,0.6715589548470183,0.7730104533627365,0.857728610000272,0.9238795325112865,0.970031253194544,0.9951847266721969,0.9987954562051724,0.9807852804032304,0.9415440651830209,0.881921264348355,0.8032075314806453],
    [-0.7071067811865477,-0.8577286100002721,-0.9569403357322089,-0.9987954562051724,-0.9807852804032304,-0.9039892931234433,-0.773010453362737,-0.5956993044924334,-0.3826834323650897,-0.14673047445536164,0.09801714032956077,0.33688985339222005,0.5555702330196023,0.7409511253549592,0.881921264348355,0.970031253194544,1,0.970031253194544,0.881921264348355,0.7409511253549592,0.5555702330196023,0.33688985339222005,0.09801714032956077,-0.14673047445536164,-0.3826834323650897,-0.5956993044924334,-0.773010453362737,-0.9039892931234433,-0.9807852804032304,-0.9987954562051724,-0.9569403357322089,-0.8577286100002721,-0.7071067811865477,-0.5141027441932218,-0.29028467725446244,-0.04906767432741803,0.1950903220161283,0.42755509343028214,0.6343932841636456,0.803207531480645,0.9238795325112865,0.9891765099647809,0.9951847266721969,0.9415440651830209,0.8314696123025456,0.6715589548470188,0.471396736825998,0.24298017990326423,3.061616997868383e-16,-0.2429801799032628,-0.4713967368259975,-0.6715589548470177,-0.8314696123025451,-0.9415440651830205,-0.9951847266721969,-0.9891765099647811,-0.9238795325112867,-0.8032075314806454,-0.6343932841636454,-0.4275550934302827,-0.19509032201612803,0.04906767432741742,0.29028467725446266,0.5141027441932213],
    [0.7071067811865474,0.42755509343028214,0.09801714032956009,-0.24298017990326412,-0.5555702330196022,-0.8032075314806449,-0.9569403357322089,-0.9987954562051724,-0.9238795325112867,-0.7409511253549589,-0.4713967368259977,-0.14673047445536164,0.19509032201612833,0.5141027441932217,0.773010453362737,0.9415440651830208,1,0.9415440651830208,0.773010453362737,0.5141027441932217,0.19509032201612833,-0.14673047445536164,-0.4713967368259977,-0.7409511253549589,-0.9238795325112867,-0.9987954562051724,-0.9569403357322089,-0.8032075314806449,-0.5555702330196022,-0.24298017990326412,0.09801714032956009,0.42755509343028214,0.7071067811865474,0.9039892931234431,0.9951847266721969,0.9700312531945441,0.8314696123025456,0.5956993044924332,0.29028467725446255,-0.04906767432741754,-0.3826834323650899,-0.6715589548470177,-0.8819212643483548,-0.989176509964781,-0.9807852804032307,-0.8577286100002723,-0.6343932841636454,-0.336889853392221,-4.286263797015736e-16,0.3368898533922202,0.6343932841636447,0.8577286100002719,0.9807852804032304,0.9891765099647811,0.8819212643483553,0.6715589548470182,0.38268343236509067,0.0490676743274184,-0.29028467725446255,-0.5956993044924326,-0.831469612302545,-0.9700312531945441,-0.9951847266721969,-0.9039892931234434],
    [0.7071067811865477,0.9415440651830209,0.9951847266721969,0.857728610000272,0.5555702330196018,0.14673047445536194,-0.29028467725446244,-0.6715589548470187,-0.9238795325112868,-0.9987954562051724,-0.8819212643483549,-0.5956993044924334,-0.1950903220161282,0.24298017990326398,0.6343932841636455,0.9039892931234433,1,0.9039892931234433,0.6343932841636455,0.24298017990326398,-0.1950903220161282,-0.5956993044924334,-0.8819212643483549,-0.9987954562051724,-0.9238795325112868,-0.6715589548470187,-0.29028467725446244,0.14673047445536194,0.5555702330196018,0.857728610000272,0.9951847266721969,0.9415440651830209,0.7071067811865477,0.33688985339222005,-0.09801714032955997,-0.5141027441932214,-0.8314696123025451,-0.989176509964781,-0.9569403357322087,-0.7409511253549599,-0.38268343236509056,0.04906767432741742,0.47139673682599736,0.8032075314806448,0.9807852804032304,0.9700312531945443,0.7730104533627377,0.4275550934302828,5.51091059616309e-16,-0.4275550934302818,-0.7730104533627369,-0.9700312531945441,-0.9807852804032307,-0.8032075314806455,-0.4713967368259983,-0.04906767432741852,0.38268343236508956,0.7409511253549591,0.9569403357322089,0.9891765099647809,0.8314696123025448,0.5141027441932239,0.09801714032956282,-0.33688985339221816],
    [-0.7071067811865467,-0.2429801799032628,0.29028467725446255,0.7409511253549592,0.9807852804032304,0.9415440651830208,0.6343932841636456,0.14673047445536194,-0.38268343236509034,-0.8032075314806449,-0.9951847266721969,-0.9039892931234433,-0.555570233019602,-0.04906767432741801,0.4713967368259978,0.8577286100002721,1,0.8577286100002721,0.4713967368259978,-0.04906767432741801,-0.555570233019602,-0.9039892931234433,-0.9951847266721969,-0.8032075314806449,-0.38268343236509034,0.14673047445536194,0.6343932841636456,0.9415440651830208,0.9807852804032304,0.7409511253549592,0.29028467725446255,-0.2429801799032628,-0.7071067811865467,-0.9700312531945441,-0.9569403357322087,-0.6715589548470182,-0.19509032201612803,0.3368898533922202,0.773010453362737,0.989176509964781,0.9238795325112867,0.5956993044924335,0.09801714032956081,-0.4275550934302818,-0.831469612302545,-0.9987954562051724,-0.8819212643483562,-0.5141027441932238,-2.4499125789312946e-15,0.5141027441932227,0.8819212643483555,0.9987954562051724,0.8314696123025448,0.4275550934302814,-0.09801714032956124,-0.5956993044924338,-0.923879532511287,-0.9891765099647809,-0.7730104533627368,-0.33688985339221983,0.19509032201612844,0.6715589548470184,0.9569403357322088,0.970031253194544],
    [-0.7071067811865471,-0.9891765099647811,-0.8819212643483548,-0.42755509343028203,0.19509032201612878,0.7409511253549592,0.9951847266721969,0.857728610000272,0.38268343236509,-0.24298017990326412,-0.7730104533627371,-0.9987954562051724,-0.8314696123025453,-0.33688985339221994,0.29028467725446233,0.8032075314806449,1,0.8032075314806449,0.29028467725446233,-0.33688985339221994,-0.8314696123025453,-0.9987954562051724,-0.7730104533627371,-0.24298017990326412,0.38268343236509,0.857728610000272,0.9951847266721969,0.7409511253549592,0.19509032201612878,-0.42755509343028203,-0.8819212643483548,-0.9891765099647811,-0.7071067811865471,-0.14673047445536166,0.47139673682599736,0.903989293123443,0.9807852804032307,0.6715589548470182,0.09801714032956081,-0.5141027441932212,-0.9238795325112864,-0.9700312531945443,-0.6343932841636456,-0.04906767432741852,0.5555702330196015,0.9415440651830204,0.9569403357322094,0.595699304492435,-9.803364199544708e-16,-0.5956993044924338,-0.9569403357322089,-0.9415440651830209,-0.5555702330196027,0.049067674327416926,0.6343932841636444,0.9700312531945435,0.9238795325112876,0.5141027441932241,-0.09801714032956099,-0.6715589548470184,-0.9807852804032303,-0.9039892931234437,-0.47139673682599875,0.1467304744553601],
    [0.7071067811865466,0.04906767432741742,-0.6343932841636454,-0.9891765099647811,-0.8314696123025451,-0.2429801799032628,0.471396736825998,0.9415440651830209,0.9238795325112865,0.42755509343028214,-0.29028467725446244,-0.8577286100002721,-0.9807852804032304,-0.5956993044924334,0.09801714032956077,0.7409511253549592,1,0.7409511253549592,0.09801714032956077,-0.5956993044924334,-0.9807852804032304,-0.8577286100002721,-0.29028467725446244,0.42755509343028214,0.9238795325112865,0.9415440651830209,0.471396736825998,-0.2429801799032628,-0.8314696123025451,-0.9891765099647811,-0.6343932841636454,0.04906767432741742,0.7071067811865466,0.9987954562051724,0.7730104533627377,0.1467304744553618,-0.5555702330196015,-0.9700312531945441,-0.8819212643483562,-0.33688985339221955,0.38268343236508956,0.9039892931234429,0.9569403357322094,0.5141027441932239,-0.19509032201612858,-0.8032075314806446,-0.995184726672197,-0.6715589548470199,-2.6948419387607653e-15,0.6715589548470184,0.9951847266721968,0.8032075314806457,0.19509032201613036,-0.5141027441932223,-0.9569403357322088,-0.9039892931234437,-0.3826834323650912,0.33688985339221783,0.8819212643483553,0.9700312531945441,0.5555702330196061,-0.1467304744553635,-0.7730104533627375,-0.9987954562051724],
    [0.7071067811865472,0.9987954562051724,0.6343932841636447,-0.14673047445536166,-0.8314696123025456,-0.9700312531945441,-0.4713967368259975,0.33688985339222005,0.9238795325112867,0.9039892931234431,0.29028467725446205,-0.5141027441932218,-0.9807852804032304,-0.8032075314806448,-0.09801714032956065,0.6715589548470184,1,0.6715589548470184,-0.09801714032956065,-0.8032075314806448,-0.9807852804032304,-0.5141027441932218,0.29028467725446205,0.9039892931234431,0.9238795325112867,0.33688985339222005,-0.4713967368259975,-0.9700312531945441,-0.8314696123025456,-0.14673047445536166,0.6343932841636447,0.9987954562051724,0.7071067811865472,-0.04906767432741729,-0.7730104533627369,-0.9891765099647811,-0.5555702330196026,0.24298017990326243,0.8819212643483555,0.9415440651830208,0.3826834323650909,-0.42755509343028003,-0.9569403357322089,-0.8577286100002726,-0.19509032201613025,0.5956993044924337,0.9951847266721968,0.7409511253549602,-7.354070601250002e-16,-0.7409511253549589,-0.995184726672197,-0.5956993044924354,0.19509032201612822,0.8577286100002715,0.9569403357322095,0.4275550934302851,-0.382683432365089,-0.9415440651830214,-0.8819212643483565,-0.24298017990326443,0.5555702330196038,0.9891765099647806,0.7730104533627371,0.04906767432742292],
    [-0.7071067811865465,0.1467304744553618,0.8819212643483553,0.903989293123443,0.1950903220161272,-0.6715589548470182,-0.9951847266721969,-0.5141027441932214,0.38268343236509045,0.9700312531945441,0.7730104533627365,-0.04906767432741803,-0.8314696123025455,-0.9415440651830207,-0.29028467725446216,0.5956993044924335,1,0.5956993044924335,-0.29028467725446216,-0.9415440651830207,-0.8314696123025455,-0.04906767432741803,0.7730104533627365,0.9700312531945441,0.38268343236509045,-0.5141027441932214,-0.9951847266721969,-0.6715589548470182,0.1950903220161272,0.903989293123443,0.8819212643483553,0.1467304744553618,-0.7071067811865465,-0.9891765099647811,-0.4713967368259983,0.4275550934302801,0.9807852804032304,0.7409511253549601,-0.09801714032956124,-0.8577286100002717,-0.9238795325112876,-0.24298017990326395,0.6343932841636444,0.9987954562051724,0.5555702330196028,-0.33688985339221794,-0.9569403357322088,-0.8032075314806458,-2.939771298590236e-15,0.8032075314806444,0.9569403357322095,0.33688985339222016,-0.555570233019601,-0.9987954562051723,-0.6343932841636489,0.24298017990326515,0.9238795325112867,0.8577286100002729,0.09801714032956356,-0.7409511253549561,-0.9807852804032302,-0.4275550934302822,0.47139673682599625,0.9891765099647806],
    [-0.7071067811865474,-0.9700312531945441,-0.29028467725446255,0.6715589548470182,0.9807852804032304,0.3368898533922202,-0.6343932841636454,-0.989176509964781,-0.3826834323650899,0.5956993044924332,0.9951847266721969,0.42755509343028214,-0.5555702330196022,-0.9987954562051724,-0.4713967368259977,0.5141027441932217,1,0.5141027441932217,-0.4713967368259977,-0.9987954562051724,-0.5555702330196022,0.42755509343028214,0.9951847266721969,0.5956993044924332,-0.3826834323650899,-0.989176509964781,-0.6343932841636454,0.3368898533922202,0.9807852804032304,0.6715589548470182,-0.29028467725446255,-0.9700312531945441,-0.7071067811865474,0.24298017990326243,0.9569403357322089,0.7409511253549601,-0.19509032201612858,-0.9415440651830203,-0.7730104533627368,0.14673047445536033,0.923879532511287,0.8032075314806457,-0.09801714032956099,-0.9039892931234428,-0.831469612302545,0.04906767432741668,0.8819212643483553,0.8577286100002728,-4.904777002955296e-16,-0.8577286100002696,-0.8819212643483565,-0.04906767432741925,0.8314696123025456,0.9039892931234453,0.09801714032956356,-0.8032075314806442,-0.9238795325112865,-0.1467304744553664,0.7730104533627351,0.9415440651830211,0.1950903220161276,-0.740951125354956,-0.9569403357322097,-0.24298017990326493],
    [0.7071067811865465,-0.33688985339221955,-0.9951847266721969,-0.5141027441932212,0.5555702330196025,0.989176509964781,0.29028467725446266,-0.7409511253549599,-0.9238795325112864,-0.04906767432741754,0.881921264348355,0.803207531480645,-0.19509032201612866,-0.970031253194544,-0.6343932841636454,0.4275550934302822,1,0.4275550934302822,-0.6343932841636454,-0.970031253194544,-0.19509032201612866,0.803207531480645,0.881921264348355,-0.04906767432741754,-0.9238795325112864,-0.7409511253549599,0.29028467725446266,0.989176509964781,0.5555702330196025,-0.5141027441932212,-0.9951847266721969,-0.33688985339221955,0.7071067811865465,0.9415440651830208,0.09801714032956282,-0.8577286100002717,-0.8314696123025449,0.14673047445536033,0.9569403357322088,0.67155895484702,-0.3826834323650892,-0.9987954562051723,-0.47139673682599875,0.5956993044924335,0.9807852804032309,0.24298017990326776,-0.7730104533627375,-0.9039892931234438,-3.1847006584197066e-15,0.9039892931234441,0.7730104533627371,-0.2429801799032616,-0.9807852804032295,-0.5956993044924329,0.47139673682599625,0.9987954562051726,0.3826834323650885,-0.6715589548470179,-0.9569403357322097,-0.14673047445536663,0.8314696123025452,0.8577286100002731,-0.09801714032955648,-0.941544065183021],
    [0.7071067811865475,0.9039892931234429,-0.0980171403295627,-0.9700312531945443,-0.5555702330196015,0.5956993044924335,0.9569403357322085,0.04906767432741742,-0.9238795325112867,-0.6715589548470177,0.471396736825998,0.9891765099647809,0.1950903220161283,-0.8577286100002721,-0.773010453362737,0.33688985339222005,1,0.33688985339222005,-0.773010453362737,-0.8577286100002721,0.1950903220161283,0.9891765099647809,0.471396736825998,-0.6715589548470177,-0.9238795325112867,0.04906767432741742,0.9569403357322085,0.5956993044924335,-0.5555702330196015,-0.9700312531945443,-0.0980171403295627,0.9039892931234429,0.7071067811865475,-0.42755509343028003,-0.995184726672197,-0.24298017990326395,0.8314696123025438,0.8032075314806457,-0.2902846772544621,-0.9987954562051723,-0.3826834323650912,0.7409511253549588,0.8819212643483564,-0.1467304744553635,-0.9807852804032297,-0.5141027441932244,0.6343932841636439,0.941544065183021,-2.45548340466059e-16,-0.9415440651830213,-0.634393284163649,0.5141027441932187,0.9807852804032309,0.146730474455363,-0.8819212643483549,-0.7409511253549584,0.3826834323650851,0.9987954562051726,0.29028467725446505,-0.8032075314806439,-0.8314696123025456,0.24298017990326445,0.9951847266721964,0.42755509343028597],
    [-0.7071067811865464,0.5141027441932239,0.9569403357322089,-0.04906767432741852,-0.9807852804032307,-0.4275550934302818,0.7730104533627377,0.8032075314806448,-0.38268343236509056,-0.989176509964781,-0.09801714032955997,0.9415440651830209,0.5555702330196018,-0.6715589548470187,-0.8819212643483549,0.24298017990326398,1,0.24298017990326398,-0.8819212643483549,-0.6715589548470187,0.5555702330196018,0.9415440651830209,-0.09801714032955997,-0.989176509964781,-0.38268343236509056,0.8032075314806448,0.7730104533627377,-0.4275550934302818,-0.9807852804032307,-0.04906767432741852,0.9569403357322089,0.5141027441932239,-0.7071067811865464,-0.8577286100002726,0.2902846772544622,0.9987954562051724,0.19509032201613036,-0.9039892931234428,-0.6343932841636459,0.5956993044924335,0.9238795325112877,-0.1467304744553635,-0.9951847266721968,-0.3368898533922236,0.8314696123025456,0.7409511253549605,-0.47139673682599326,-0.9700312531945442,-3.4296300182491773e-15,0.9700312531945442,0.4713967368259993,-0.740951125354956,-0.8314696123025453,0.33688985339221716,0.9951847266721968,0.14673047445536325,-0.9238795325112851,-0.5956993044924332,0.6343932841636434,0.9039892931234457,-0.19509032201612714,-0.9987954562051722,-0.290284677254462,0.8577286100002709],
    [-0.7071067811865476,-0.8032075314806446,0.4713967368259984,0.9415440651830204,-0.19509032201613002,-0.9987954562051724,-0.09801714032955972,0.9700312531945443,0.3826834323650898,-0.8577286100002723,-0.6343932841636448,0.6715589548470188,0.8314696123025452,-0.4275550934302825,-0.9569403357322088,0.14673047445536175,1,0.14673047445536175,-0.9569403357322088,-0.4275550934302825,0.8314696123025452,0.6715589548470188,-0.6343932841636448,-0.8577286100002723,0.3826834323650898,0.9700312531945443,-0.09801714032955972,-0.9987954562051724,-0.19509032201613002,0.9415440651830204,0.4713967368259984,-0.8032075314806446,-0.7071067811865476,0.5956993044924337,0.8819212643483563,-0.33688985339221794,-0.9807852804032308,0.04906767432741668,0.9951847266721968,0.24298017990326776,-0.9238795325112854,-0.5141027441932244,0.7730104533627352,0.7409511253549605,-0.5555702330196007,-0.9039892931234439,0.2902846772544615,0.989176509964781,-6.189806365883577e-19,-0.989176509964781,-0.2902846772544615,0.9039892931234439,0.5555702330196066,-0.7409511253549558,-0.7730104533627398,0.5141027441932183,0.9238795325112881,-0.24298017990326087,-0.9951847266721972,-0.04906767432742023,0.9807852804032301,0.33688985339222133,-0.8819212643483513,-0.5956993044924337],
    [0.7071067811865462,-0.6715589548470199,-0.7730104533627357,0.595699304492435,0.831469612302544,-0.5141027441932238,-0.8819212643483547,0.4275550934302828,0.9238795325112864,-0.336889853392221,-0.9569403357322085,0.24298017990326423,0.9807852804032303,-0.1467304744553623,-0.9951847266721968,0.049067674327418126,1,0.049067674327418126,-0.9951847266721968,-0.1467304744553623,0.9807852804032303,0.24298017990326423,-0.9569403357322085,-0.336889853392221,0.9238795325112864,0.4275550934302828,-0.8819212643483547,-0.5141027441932238,0.831469612302544,0.595699304492435,-0.7730104533627357,-0.6715589548470199,0.7071067811865462,0.7409511253549602,-0.6343932841636443,-0.8032075314806458,0.5555702330196011,0.8577286100002728,-0.4713967368259935,-0.9039892931234438,0.38268343236508556,0.941544065183021,-0.2902846772544582,-0.9700312531945442,0.19509032201612425,0.989176509964781,-0.09801714032955673,-0.9987954562051724,-3.674559378078648e-15,0.9987954562051724,0.09801714032956405,-0.989176509964781,-0.19509032201613144,0.9700312531945441,0.2902846772544653,-0.941544065183021,-0.3826834323650924,0.9039892931234437,0.4713967368259999,-0.8577286100002727,-0.5555702330196102,0.8032075314806414,0.6343932841636472,-0.7409511253549601],
    [0.7071067811865476,0.6715589548470184,-0.7730104533627368,-0.5956993044924338,0.8314696123025448,0.5141027441932227,-0.8819212643483562,-0.4275550934302818,0.9238795325112867,0.3368898533922202,-0.9569403357322087,-0.2429801799032628,0.9807852804032304,0.14673047445536194,-0.9951847266721969,-0.04906767432741801,1,-0.04906767432741801,-0.9951847266721969,0.14673047445536194,0.9807852804032304,-0.2429801799032628,-0.9569403357322087,0.3368898533922202,0.9238795325112867,-0.4275550934302818,-0.8819212643483562,0.5141027441932227,0.8314696123025448,-0.5956993044924338,-0.7730104533627368,0.6715589548470184,0.7071067811865476,-0.7409511253549589,-0.6343932841636459,0.8032075314806444,0.5555702330196061,-0.8577286100002696,-0.47139673682599587,0.9039892931234441,0.3826834323650883,-0.9415440651830213,-0.2902846772544613,0.9700312531945442,0.1950903220161276,-0.989176509964781,-0.09801714032956038,0.9987954562051724,2.443103791928823e-16,-0.9987954562051724,0.0980171403295599,0.9891765099647811,-0.19509032201612714,-0.9700312531945443,0.29028467725446083,0.9415440651830214,-0.3826834323650813,-0.9039892931234473,0.47139673682598915,0.8577286100002699,-0.5555702330196056,-0.8032075314806426,0.6343932841636484,0.7409511253549568],
    [-0.7071067811865461,0.8032075314806457,0.4713967368259969,-0.9415440651830209,-0.19509032201612858,0.9987954562051724,-0.0980171403295627,-0.9700312531945441,0.38268343236509067,0.8577286100002719,-0.6343932841636454,-0.6715589548470177,0.8314696123025456,0.42755509343028214,-0.9569403357322089,-0.14673047445536164,1,-0.14673047445536164,-0.9569403357322089,0.42755509343028214,0.8314696123025456,-0.6715589548470177,-0.6343932841636454,0.8577286100002719,0.38268343236509067,-0.9700312531945441,-0.0980171403295627,0.9987954562051724,-0.19509032201612858,-0.9415440651830209,0.4713967368259969,0.8032075314806457,-0.7071067811865461,-0.5956993044924354,0.8819212643483553,0.33688985339222016,-0.9807852804032297,-0.04906767432741925,0.9951847266721967,-0.2429801799032616,-0.9238795325112865,0.5141027441932187,0.7730104533627373,-0.740951125354956,-0.5555702330196036,0.9039892931234439,0.29028467725446505,-0.989176509964781,-3.919488737908119e-15,0.9891765099647811,-0.29028467725445756,-0.9039892931234442,0.555570233019603,0.7409511253549612,-0.7730104533627369,-0.5141027441932254,0.9238795325112835,0.2429801799032623,-0.9951847266721966,0.04906767432741142,0.9807852804032298,-0.33688985339221944,-0.8819212643483573,0.5956993044924263],
    [-0.7071067811865477,-0.5141027441932223,0.9569403357322095,0.049067674327416926,-0.9807852804032304,0.4275550934302814,0.7730104533627358,-0.8032075314806455,-0.38268343236508967,0.9891765099647811,-0.09801714032956069,-0.9415440651830205,0.5555702330196023,0.6715589548470183,-0.881921264348355,-0.24298017990326387,1,-0.24298017990326387,-0.881921264348355,0.6715589548470183,0.5555702330196023,-0.9415440651830205,-0.09801714032956069,0.9891765099647811,-0.38268343236508967,-0.8032075314806455,0.7730104533627358,0.4275550934302814,-0.9807852804032304,0.049067674327416926,0.9569403357322095,-0.5141027441932223,-0.7071067811865477,0.8577286100002715,0.29028467725446433,-0.9987954562051723,0.19509032201612447,0.9039892931234453,-0.6343932841636466,-0.5956993044924329,0.9238795325112866,0.146730474455363,-0.9951847266721972,0.33688985339221716,0.8314696123025475,-0.7409511253549558,-0.4713967368259965,0.9700312531945441,4.892397390223529e-16,-0.9700312531945443,0.47139673682599564,0.7409511253549612,-0.8314696123025429,-0.33688985339221805,0.9951847266721963,-0.14673047445536205,-0.9238795325112897,0.5956993044924321,0.6343932841636528,-0.9039892931234419,-0.19509032201612544,0.9987954562051726,-0.2902846772544634,-0.8577286100002757],
    [0.707106781186546,-0.9039892931234437,-0.09801714032956099,0.9700312531945435,-0.5555702330196027,-0.5956993044924338,0.9569403357322094,-0.04906767432741852,-0.9238795325112864,0.6715589548470182,0.47139673682599736,-0.9891765099647811,0.19509032201612878,0.857728610000272,-0.7730104533627371,-0.33688985339221994,1,-0.33688985339221994,-0.7730104533627371,0.857728610000272,0.19509032201612878,-0.9891765099647811,0.47139673682599736,0.6715589548470182,-0.9238795325112864,-0.04906767432741852,0.9569403357322094,-0.5956993044924338,-0.5555702330196027,0.9700312531945435,-0.09801714032956099,-0.9039892931234437,0.707106781186546,0.4275550934302851,-0.9951847266721968,0.24298017990326515,0.8314696123025471,-0.8032075314806442,-0.2902846772544613,0.9987954562051726,-0.3826834323650885,-0.7409511253549584,0.8819212643483533,0.14673047445536325,-0.9807852804032303,0.5141027441932183,0.6343932841636468,-0.941544065183021,-4.164418097737589e-15,0.9415440651830214,-0.6343932841636404,-0.5141027441932254,0.9807852804032301,-0.14673047445536205,-0.8819212643483538,0.7409511253549529,0.3826834323650962,-0.9987954562051722,0.2902846772544601,0.8032075314806449,-0.8314696123025465,-0.24298017990327322,0.9951847266721976,-0.4275550934302776],
    [0.7071067811865503,0.33688985339221783,-0.9951847266721968,0.5141027441932241,0.5555702330196013,-0.9891765099647809,0.2902846772544639,0.7409511253549591,-0.9238795325112875,0.0490676743274184,0.8819212643483547,-0.8032075314806454,-0.1950903220161273,0.970031253194544,-0.6343932841636459,-0.42755509343028186,1,-0.42755509343028186,-0.6343932841636459,0.970031253194544,-0.1950903220161273,-0.8032075314806454,0.8819212643483547,0.0490676743274184,-0.9238795325112875,0.7409511253549591,0.2902846772544639,-0.9891765099647809,0.5555702330196013,0.5141027441932241,-0.9951847266721968,0.33688985339221783,0.7071067811865503,-0.9415440651830214,0.09801714032956063,0.8577286100002729,-0.8314696123025435,-0.1467304744553664,0.9569403357322086,-0.6715589548470179,-0.38268343236509195,0.9987954562051726,-0.4713967368259928,-0.5956993044924332,0.9807852804032302,-0.24298017990326087,-0.77301045336274,0.9039892931234437,7.839596456452825e-15,-0.9039892931234473,0.773010453362739,0.2429801799032623,-0.9807852804032304,0.5956993044924321,0.47139673682600036,-0.9987954562051722,0.382683432365084,0.6715589548470242,-0.9569403357322062,0.14673047445536494,0.8314696123025443,-0.8577286100002721,-0.09801714032956209,0.9415440651830218],
    [-0.707106781186546,0.9700312531945441,-0.2902846772544642,-0.6715589548470184,0.9807852804032308,-0.33688985339221983,-0.6343932841636444,0.9891765099647809,-0.3826834323650908,-0.5956993044924326,0.9951847266721969,-0.4275550934302827,-0.5555702330196017,0.9987954562051724,-0.4713967368259979,-0.5141027441932216,1,-0.5141027441932216,-0.4713967368259979,0.9987954562051724,-0.5555702330196017,-0.4275550934302827,0.9951847266721969,-0.5956993044924326,-0.3826834323650908,0.9891765099647809,-0.6343932841636444,-0.33688985339221983,0.9807852804032308,-0.6715589548470184,-0.2902846772544642,0.9700312531945441,-0.707106781186546,-0.24298017990326443,0.9569403357322086,-0.7409511253549561,-0.19509032201613097,0.9415440651830211,-0.7730104533627373,-0.14673047445536663,0.9238795325112881,-0.8032075314806439,-0.09801714032956063,0.9039892931234457,-0.8314696123025431,-0.04906767432742023,0.8819212643483553,-0.8577286100002727,-4.40934745756706e-15,0.8577286100002699,-0.8819212643483545,0.04906767432741142,0.831469612302544,-0.9039892931234419,0.09801714032955186,0.8032075314806449,-0.9238795325112846,0.14673047445536494,0.7730104533627383,-0.9415440651830181,0.1950903220161293,0.7409511253549621,-0.9569403357322059,0.2429801799032628],
    [-0.7071067811865479,-0.1467304744553635,0.8819212643483553,-0.9039892931234437,0.19509032201613036,0.6715589548470184,-0.995184726672197,0.5141027441932239,0.38268343236508956,-0.9700312531945441,0.7730104533627377,0.04906767432741742,-0.8314696123025451,0.9415440651830209,-0.29028467725446244,-0.5956993044924334,1,-0.5956993044924334,-0.29028467725446244,0.9415440651830209,-0.8314696123025451,0.04906767432741742,0.7730104533627377,-0.9700312531945441,0.38268343236508956,0.5141027441932239,-0.995184726672197,0.6715589548470184,0.19509032201613036,-0.9039892931234437,0.8819212643483553,-0.1467304744553635,-0.7071067811865479,0.9891765099647806,-0.47139673682599326,-0.4275550934302822,0.9807852804032309,-0.740951125354956,-0.09801714032956038,0.8577286100002731,-0.9238795325112851,0.24298017990326445,0.6343932841636468,-0.9987954562051722,0.555570233019603,0.33688985339222133,-0.9569403357322078,0.8032075314806414,9.790984586812941e-16,-0.8032075314806426,0.9569403357322073,-0.33688985339221944,-0.5555702330196105,0.9987954562051726,-0.6343932841636453,-0.24298017990327322,0.9238795325112886,-0.8577286100002721,0.09801714032955137,0.7409511253549621,-0.9807852804032305,0.42755509343027404,0.47139673682600125,-0.9891765099647809],
    [0.7071067811865483,-0.9987954562051724,0.634393284163646,0.1467304744553601,-0.8314696123025438,0.970031253194544,-0.47139673682599853,-0.33688985339221816,0.923879532511287,-0.9039892931234434,0.2902846772544636,0.5141027441932213,-0.9807852804032305,0.8032075314806453,-0.09801714032956045,-0.6715589548470184,1,-0.6715589548470184,-0.09801714032956045,0.8032075314806453,-0.9807852804032305,0.5141027441932213,0.2902846772544636,-0.9039892931234434,0.923879532511287,-0.33688985339221816,-0.47139673682599853,0.970031253194544,-0.8314696123025438,0.1467304744553601,0.634393284163646,-0.9987954562051724,0.7071067811865483,0.04906767432742292,-0.7730104533627394,0.9891765099647806,-0.5555702330196005,-0.24298017990326493,0.881921264348355,-0.941544065183021,0.3826834323650849,0.42755509343028597,-0.9569403357322098,0.8577286100002709,-0.1950903220161269,-0.5956993044924337,0.9951847266721968,-0.7409511253549601,2.4511505402044715e-15,0.7409511253549568,-0.9951847266721959,0.5956993044924263,0.19509032201613602,-0.8577286100002757,0.9569403357322072,-0.4275550934302776,-0.3826834323650935,0.9415440651830218,-0.881921264348354,0.2429801799032628,0.5555702330196024,-0.9891765099647809,0.7730104533627381,-0.04906767432742072],
    [0.7071067811865505,-0.04906767432741925,-0.6343932841636468,0.9891765099647806,-0.831469612302545,0.2429801799032641,0.4713967368259969,-0.9415440651830203,0.9238795325112875,-0.4275550934302813,-0.29028467725446255,0.8577286100002719,-0.9807852804032307,0.5956993044924332,0.09801714032956009,-0.7409511253549589,1,-0.7409511253549589,0.09801714032956009,0.5956993044924332,-0.9807852804032307,0.8577286100002719,-0.29028467725446255,-0.4275550934302813,0.9238795325112875,-0.9415440651830203,0.4713967368259969,0.2429801799032641,-0.831469612302545,0.9891765099647806,-0.6343932841636468,-0.04906767432741925,0.7071067811865505,-0.9987954562051724,0.7730104533627351,-0.146730474455363,-0.5555702330196036,0.9700312531945451,-0.8819212643483548,0.33688985339221694,0.382683432365089,-0.9039892931234442,0.9569403357322074,-0.5141027441932149,-0.19509032201612497,0.8032075314806446,-0.9951847266721966,0.6715589548470144,8.329455176111767e-15,-0.6715589548470162,0.9951847266721969,-0.8032075314806432,0.19509032201612256,0.5141027441932292,-0.9569403357322082,0.9039892931234432,-0.38268343236508673,-0.33688985339222594,0.8819212643483594,-0.9700312531945445,0.5555702330196015,0.14673047445536544,-0.7730104533627412,0.998795456205172],
    [-0.7071067811865458,0.9891765099647806,-0.8819212643483565,0.4275550934302851,0.19509032201612822,-0.7409511253549589,0.9951847266721968,-0.8577286100002726,0.3826834323650909,0.24298017990326243,-0.7730104533627369,0.9987954562051724,-0.8314696123025456,0.33688985339222005,0.29028467725446205,-0.8032075314806448,1,-0.8032075314806448,0.29028467725446205,0.33688985339222005,-0.8314696123025456,0.9987954562051724,-0.7730104533627369,0.24298017990326243,0.3826834323650909,-0.8577286100002726,0.9951847266721968,-0.7409511253549589,0.19509032201612822,0.4275550934302851,-0.8819212643483565,0.9891765099647806,-0.7071067811865458,0.1467304744553596,0.4713967368259993,-0.903989293123444,0.9807852804032302,-0.6715589548470177,0.0980171403295599,0.5141027441932221,-0.9238795325112868,0.9700312531945441,-0.6343932841636404,0.049067674327418764,0.5555702330196073,-0.9415440651830204,0.9569403357322073,-0.5956993044924349,-4.899206177226001e-15,0.5956993044924314,-0.9569403357322102,0.9415440651830218,-0.5555702330195991,-0.04906767432742855,0.6343932841636479,-0.9700312531945464,0.9238795325112857,-0.5141027441932137,-0.09801714032956259,0.6715589548470249,-0.9807852804032308,0.9039892931234398,-0.4713967368259969,-0.1467304744553693],
    [-0.707106781186548,0.242980179903268,0.2902846772544618,-0.7409511253549563,0.9807852804032303,-0.9415440651830209,0.6343932841636458,-0.14673047445536216,-0.38268343236508945,0.8032075314806447,-0.9951847266721968,0.9039892931234434,-0.5555702330196024,0.049067674327418154,0.4713967368259976,-0.857728610000272,1,-0.857728610000272,0.4713967368259976,0.049067674327418154,-0.5555702330196024,0.9039892931234434,-0.9951847266721968,0.8032075314806447,-0.38268343236508945,-0.14673047445536216,0.6343932841636458,-0.9415440651830209,0.9807852804032303,-0.7409511253549563,0.2902846772544618,0.242980179903268,-0.707106781186548,0.9700312531945451,-0.9569403357322086,0.6715589548470151,-0.19509032201612736,-0.3368898533922243,0.7730104533627375,-0.9891765099647817,0.9238795325112863,-0.5956993044924352,0.09801714032955235,0.4275550934302864,-0.8314696123025459,0.9987954562051723,-0.881921264348351,0.5141027441932174,1.4689571783402355e-15,-0.51410274419322,0.8819212643483592,-0.9987954562051722,0.8314696123025443,-0.42755509343028375,-0.09801714032956942,0.5956993044924376,-0.9238795325112874,0.9891765099647812,-0.7730104533627312,0.33688985339221483,0.19509032201613025,-0.6715589548470173,0.9569403357322115,-0.9700312531945426],
    [0.7071067811865482,-0.9415440651830213,0.9951847266721967,-0.857728610000271,0.5555702330196061,-0.14673047445536241,-0.2902846772544621,0.6715589548470184,-0.923879532511287,0.9987954562051724,-0.8819212643483562,0.5956993044924335,-0.19509032201612803,-0.2429801799032628,0.6343932841636456,-0.9039892931234433,1,-0.9039892931234433,0.6343932841636456,-0.2429801799032628,-0.19509032201612803,0.5956993044924335,-0.8819212643483562,0.9987954562051724,-0.923879532511287,0.6715589548470184,-0.2902846772544621,-0.14673047445536241,0.5555702330196061,-0.857728610000271,0.9951847266721967,-0.9415440651830213,0.7071067811865482,-0.3368898533922206,-0.09801714032956038,0.5141027441932219,-0.8314696123025456,0.9891765099647811,-0.9569403357322085,0.7409511253549579,-0.3826834323650813,-0.04906767432742757,0.4713967368259939,-0.8032075314806426,0.9807852804032298,-0.9700312531945448,0.7730104533627387,-0.4275550934302842,1.96129182054553e-15,0.42755509343028064,-0.7730104533627362,0.9700312531945438,-0.9807852804032305,0.8032075314806449,-0.47139673682599736,0.0490676743274173,0.3826834323650908,-0.7409511253549601,0.9569403357322094,-0.9891765099647807,0.8314696123025438,-0.5141027441932191,0.09801714032955722,0.3368898533922236],
    [0.7071067811865507,-0.4275550934302822,0.09801714032956356,0.24298017990326515,-0.555570233019601,0.8032075314806444,-0.9569403357322088,0.9987954562051724,-0.9238795325112876,0.7409511253549601,-0.4713967368259983,0.1467304744553618,0.1950903220161272,-0.5141027441932214,0.7730104533627365,-0.9415440651830207,1,-0.9415440651830207,0.7730104533627365,-0.5141027441932214,0.1950903220161272,0.1467304744553618,-0.4713967368259983,0.7409511253549601,-0.9238795325112876,0.9987954562051724,-0.9569403357322088,0.8032075314806444,-0.555570233019601,0.24298017990326515,0.09801714032956356,-0.4275550934302822,0.7071067811865507,-0.903989293123444,0.9951847266721968,-0.9700312531945433,0.8314696123025451,-0.5956993044924298,0.29028467725446083,0.04906767432741681,-0.3826834323650926,0.6715589548470239,-0.8819212643483538,0.9891765099647812,-0.9807852804032293,0.8577286100002668,-0.6343932841636453,0.3368898533922158,8.819313895770708e-15,-0.336889853392219,0.6343932841636479,-0.8577286100002759,0.98078528040323,-0.9891765099647807,0.8819212643483522,-0.6715589548470108,0.38268343236508945,-0.04906767432741338,-0.2902846772544709,0.5956993044924325,-0.831469612302547,0.9700312531945459,-0.9951847266721972,0.9039892931234365],
    [-0.7071067811865457,0.8577286100002712,-0.9569403357322087,0.9987954562051724,-0.9807852804032302,0.9039892931234438,-0.7730104533627369,0.5956993044924352,-0.382683432365091,0.14673047445536205,0.09801714032956137,-0.3368898533922201,0.5555702330196016,-0.7409511253549593,0.8819212643483548,-0.970031253194544,1,-0.970031253194544,0.8819212643483548,-0.7409511253549593,0.5555702330196016,-0.3368898533922201,0.09801714032956137,0.14673047445536205,-0.382683432365091,0.5956993044924352,-0.7730104533627369,0.9039892931234438,-0.9807852804032302,0.9987954562051724,-0.9569403357322087,0.8577286100002712,-0.7071067811865457,0.5141027441932186,-0.2902846772544578,0.04906767432741926,0.19509032201612808,-0.42755509343028286,0.634393284163647,-0.8032075314806467,0.9238795325112856,-0.9891765099647817,0.9951847266721969,-0.9415440651830184,0.8314696123025446,-0.6715589548470114,0.47139673682599476,-0.2429801799032666,-5.389064896884942e-15,0.24298017990326326,-0.47139673682600425,0.6715589548470194,-0.8314696123025506,0.941544065183022,-0.9951847266721966,0.9891765099647801,-0.923879532511287,0.8032075314806403,-0.6343932841636442,0.42755509343027315,-0.19509032201612447,-0.04906767432741582,0.2902846772544681,-0.5141027441932339],
    [-0.7071067811865482,0.5956993044924359,-0.47139673682599603,0.3368898533922204,-0.19509032201613072,0.04906767432742268,0.09801714032956088,-0.24298017990326207,0.38268343236508934,-0.5141027441932225,0.6343932841636445,-0.7409511253549592,0.8314696123025451,-0.9039892931234431,0.9569403357322088,-0.989176509964781,1,-0.989176509964781,0.9569403357322088,-0.9039892931234431,0.8314696123025451,-0.7409511253549592,0.6343932841636445,-0.5141027441932225,0.38268343236508934,-0.24298017990326207,0.09801714032956088,0.04906767432742268,-0.19509032201613072,0.3368898533922204,-0.47139673682599603,0.5956993044924359,-0.7071067811865482,0.8032075314806442,-0.8819212643483568,0.9415440651830214,-0.9807852804032303,0.9987954562051726,-0.9951847266721959,0.9700312531945422,-0.9238795325112849,0.8577286100002706,-0.7730104533627365,0.6715589548470194,-0.5555702330196053,0.4275550934302745,-0.29028467725445634,0.14673047445535767,1.9588158979991767e-15,-0.14673047445536155,0.2902846772544601,-0.42755509343029086,0.5555702330196085,-0.6715589548470224,0.773010453362739,-0.8577286100002727,0.9238795325112863,-0.9700312531945466,0.9951847266721977,-0.9987954562051727,0.9807852804032268,-0.9415440651830153,0.8819212643483483,-0.8032075314806376],
    [0.7071067811865481,-0.740951125354956,0.7730104533627351,-0.8032075314806442,0.8314696123025456,-0.8577286100002696,0.8819212643483553,-0.9039892931234428,0.923879532511287,-0.9415440651830203,0.9569403357322089,-0.9700312531945441,0.9807852804032304,-0.989176509964781,0.9951847266721969,-0.9987954562051724,1,-0.9987954562051724,0.9951847266721969,-0.989176509964781,0.9807852804032304,-0.9700312531945441,0.9569403357322089,-0.9415440651830203,0.923879532511287,-0.9039892931234428,0.8819212643483553,-0.8577286100002696,0.8314696123025456,-0.8032075314806442,0.7730104533627351,-0.740951125354956,0.7071067811865481,-0.6715589548470177,0.6343932841636434,-0.5956993044924298,0.555570233019603,-0.5141027441932149,0.47139673682598915,-0.42755509343028464,0.3826834323650908,-0.33688985339221944,0.2902846772544601,-0.24298017990325993,0.19509032201612256,-0.14673047445535428,0.09801714032955137,-0.049067674327421214,1.471433100886589e-15,0.04906767432741827,-0.09801714032956259,0.14673047445536544,-0.1950903220161336,0.24298017990327087,-0.2902846772544709,0.33688985339223004,-0.38268343236508806,0.427555093430282,-0.47139673682601163,0.5141027441932247,-0.5555702330196183,0.5956993044924388,-0.6343932841636412,0.671558954847026]
];


// 输入：512个样本，其中前32个是滤波器的输入。
//       可以理解成一个512点的窗口从左向右滑过样本，每次滑动步进32点。窗口最右侧为0，最左侧为511，与输入序列**顺序相反**。窗口最右侧为实际的输入，其左侧为缓冲区。
// 输出：长度为32的子带滤波结果，每一点代表每一频带在此32点时域窗口对应的时间点上的（降）采样值

function BasicAnalysisSubbandFilter(inputBuffer) { // def. @ p.67,78

    // Window by 512 Coefficients (ANALYSIS_SUBBAND_FILTER_WINDOW_COEFFICIENTS[])
    let Z = new Array(); // length = 512
    for(let i = 0; i < 512; i++) {
        Z[i] = inputBuffer[i] * ANALYSIS_SUBBAND_FILTER_WINDOW_COEFFICIENTS[i];
    }

    // Partial Calculation
    let Y = new Array(); // length = 64
    for(let i = 0; i < 64; i++) {
        let sum = 0;
        for(let j = 0; j < 8; j++) {
            sum += Z[i + 64 * j];
        }
        Y[i] = sum;
    }

    // Calculate 32 Samples by Matrixing
    // NOTE 考虑到性能，并不调用此函数，而是查表M_Mat
    // const M = (i, k) => { // def. @ p.67
    //     return Math.cos((2 * i + 1) * (k - 16) * Math.PI / 64); // for i = 0 to 31, and k = 0 to 63.
    // }
    let S = new Array(); // length = 32
    for(let i = 0; i < 32; i++) {
        let sum = 0;
        for(let k = 0; k < 64; k++) {
            sum += (M_Mat[i][k]/*M(i, k)*/ * Y[k]);
        }
        S[i] = sum;
    }

    // Output 32 Subband Samples
    return S;

}

// 输入：原始PCM序列；Granule（576点）起点index
// 输出：32个频带的时域序列，每个序列18点
function AnalysisSubbandFilter(PCMData, GranuleStartOffset) {
    // 滑动窗口，对一帧节进行分析子带滤波
    let Outputs = new Array(); // 此数组存储18个子带滤波结果，每个结果有32点
    for(let step = 1; step <= 18; step++) {
        let offset = GranuleStartOffset + 32 * step;
        let inputBuffer = new Array();
        // 倒序从原始序列读取512个采样，原始序列第一个采样之前的值以0填充
        for(let i = 0; i < 512; i++) {
            let dataIndex = offset - i;
            inputBuffer[i] = (dataIndex >= 0 && dataIndex < PCMData.length) ? PCMData[dataIndex] : 0;
        }
        // 滤波
        let output = BasicAnalysisSubbandFilter(inputBuffer);
        Outputs[step-1] = output;
    }
    // 将结果转换为32个频带的结果
    let Subbands = new Array();
    for(let t = 0; t < Outputs.length; t++) {
        for(let band = 0; band < Outputs[t].length; band++) {
            if(Subbands[band] === undefined) {
                Subbands[band] = new Array();
            }
            Subbands[band][t] = Outputs[t][band];
            // NOTE 由于子带滤波器的输入缓冲区是反向的，因此需要对输出结果做处理。这个问题是在dist10源码中发现的。
            if((band % 2 === 1) && (t % 2 === 1)) {
                Subbands[band][t] *= -1;
            }
        }
    }

    return Subbands;
}

